var sli=null;t=function(){clearTimeout(sli),sli=setTimeout(GetServerInfoService,5e3)},GetLoading=function(){$("body").css({opacity:".5"}),$("body").append('<div class="loader">Loading...</div>')},GetLoaded=function(){$("body").animate({opacity:"1"}),$(".loader").fadeOut("slow",function(){$(this).remove()})},GetMonsterAppService=function(){$.getJSON(MenuMonsterAppServiceGet,function(data){var tpl=$("#tpl-app").html(),html=Mustache.to_html(tpl,data);$("#app-menu").html(html)})},GetServerInfoService=function(){$.getJSON(Web1AppServiceGet,function(data){$.each(data,function(i,item){$.each(item.stats,function(x,obj){"c"===obj.type[0]?$("#web1app-cpu").css({width:obj.value+"%"}):$("#web1app-ram").css({width:obj.value+"%"})})})}),$.getJSON(Db1LucyServiceGet,function(data){$.each(data,function(i,item){$.each(item.stats,function(x,obj){"c"===obj.type[0]?$("#db1-cpu").css({width:obj.value+"%"}):$("#db1-ram").css({width:obj.value+"%"})})}),t()})};var requests={init:function(){var self=this;self.parseRequests()},parseRequests:function(){var self=this;$.when(self.getRequests(RequestsServiceGet01),self.getRequests(RequestsServiceGet02),self.getRequests(RequestsServiceGet03),self.getRequests(RequestsServiceGet04)).fail(function(){console.log("error")}).done(function(a,b,c,d){var allRequests=[].concat(a[0]).concat(b[0]).concat(c[0]).concat(d[0]);self.showRequests(allRequests)})},getRequests:function(url){return $.getJSON(url)},literalToDate:function(obj){var exp=/(\d{4})\-(\d{2})\-(\d{2})T(\d{2}):(\d{2}):(\d{2}) ([\+\-])(\d{2}):(\d{2})/,dateString=obj.replace(exp,"$1/$2/$3 $4:$5:$6 $7$8$9");return new Date(dateString)},showRequests:function(requests){var cd=0,td=0,md=0,cw=0,tw=0,mw=0,cm=0,tm=0,mm=0,inicialDate=new Date("2014-07-16T01:00:00+03:00");$.each(requests,function(){var rt=this.response_time,dt=new Date(this.date);ms=inicialDate.getTime()-dt.getTime(),864e5>=ms?(cd++,td+=parseInt(rt),md=td/requests.length):6048e5>=ms?(cw++,tw+=parseInt(rt),mw=tw/requests.length):2592e6>=ms&&(cm++,tm+=parseInt(rt),mm=tm/requests.length)}),$("#cd").text(cd),$("#md span").text(md.toFixed(2)),$("#cw").text(cw),$("#mw span").text(mw.toFixed(2)),$("#cm").text(cm),$("#mm span").text(mm.toFixed(2)),GetLoaded()}};$(function(){GetLoading(),GetMonsterAppService(),GetServerInfoService(),requests.init(),setTimeout(GetServerInfoService,5e3),setTimeout(requests.init,5e3),$("#app").click(function(e){$("#app-menu").toggle(200),e.preventDefault()}),$("#mrt-body, nav, #app-menu").click(function(e){$("#app-menu").hide(200),e.preventDefault()}),$("#git").click(function(e){$.getJSON(GitCloneServiceGet,function(){}).fail(function(jqXHR){jAlert(jqXHR.responseJSON.msg,jqXHR.statusText)}),e.preventDefault()}),setStorage=function(){localStorage.input_1&&$("#input_1").val(localStorage.input_1),localStorage.input_2&&$("#input_2").val(localStorage.input_2),localStorage.input_3&&$("#input_3").val(localStorage.input_3),localStorage.input_4&&$("#input_4").val(localStorage.input_4)}(),$(".input").change(function(){localStorage[$(this).attr("name")]=$(this).val()}),$("#salvar").click(function(){localStorage.clear(),$("#variables").each(function(){this.reset()})})});